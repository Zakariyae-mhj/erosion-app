import streamlit as st
from PIL import Image
import os

# --- ุฅุนุฏุงุฏุงุช ุงูุตูุญุฉ ุงูุฃุณุงุณูุฉ ---
st.set_page_config(
    page_title="ุงููุญุฌูุจู ุฒูุฑูุงุกุ ูุดุงู ูุณูุน - ููููุฉ ุงููุณุทู",
    page_icon="๐๏ธ",
    layout="wide",
    initial_sidebar_state="expanded"
)

# --- ุชุญุณููุงุช ุงูุชุตููู (CSS) ูุงูุฎุทูุท ุงูุนุฑุจูุฉ ---
st.markdown(
    """
    <style>
    /* ุงุณุชูุฑุงุฏ ุฎุท ุนุฑุจู ุงุญุชุฑุงูู (Cairo) */
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700&display=swap');

    /* ุชุทุจูู ุงูุฎุท ูุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ */
    html, body, [class*="css"] {
        font-family: 'Cairo', sans-serif;
    }

    /* ุฅุฌุจุงุฑ ุงูุงุชุฌุงู ูู ุงููููู ูููุณุงุฑ (RTL) */
    [data-testid="stAppViewContainer"] {
        direction: rtl;
        text-align: right;
        background-color: #fdfdfd; /* ุฎูููุฉ ูุงุชุญุฉ ุฌุฏุงู */
    }

    /* ุชูุณูู ุงูุนูุงููู */
    h1, h2, h3 {
        color: #2c3e50; /* ููู ุฏุงูู ููุนูุงููู */
        font-weight: 700;
    }
    h1 {
        text-align: center !important;
        padding-bottom: 20px;
        color: #8e44ad; /* ููู ูููุฒ ููุนููุงู ุงูุฑุฆูุณู */
    }

    /* ุชูุณูู ุงูุดุฑูุท ุงูุฌุงูุจู */
    section[data-testid="stSidebar"] {
        background-color: #ecf0f1; /* ููู ุฎูููุฉ ูุงุชุญ ููุดุฑูุท ุงูุฌุงูุจู */
        border-left: 1px solid #bdc3c7;
    }

    /* ุชูุณูู ูุฑุจุนุงุช ุงููุนูููุงุช */
    .stInfo, .stWarning, .stSuccess {
        border-radius: 10px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }

    /* ุชุญุณูู ูุธูุฑ ุนูุงูุงุช ุงูุชุจููุจ (Tabs) */
    .stTabs [data-baseweb="tab-list"] {
        gap: 10px;
        background-color: transparent;
        padding: 5px;
        border-radius: 10px;
    }
    .stTabs [data-baseweb="tab"] {
        height: 50px;
        white-space: pre-wrap;
        background-color: #ffffff;
        border-radius: 8px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
        color: #555;
        font-weight: bold;
    }
    .stTabs [aria-selected="true"] {
        background-color: #3498db !important; /* ููู ุงูุชุจููุจ ุงููุดุท */
        color: white !important;
    }

    /* ุญุงููุงุช ูุฎุตุตุฉ ููุตูุฑ ูุงููุตูุต */
    .custom-container {
        background-color: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        margin-bottom: 25px;
        border-top: 4px solid #3498db; /* ุดุฑูุท ูููู ุนููู */
    }
    .header-banner {
        background: linear-gradient(90deg, #3498db, #8e44ad);
        padding: 30px;
        border-radius: 15px;
        color: white;
        text-align: center;
        margin-bottom: 30px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    .header-banner h1 {
        color: white !important;
        margin: 0;
    }

    /* ุฅุตูุงุญุงุช RTL */
    h1, h2, h3, h4, h5, h6, p, span, div, label, .stMarkdown, .stText {
        text-align: right !important;
    }
    .stImage > div > div > div {
         text-align: center !important;
    }
    </style>
    """,
    unsafe_allow_html=True,
)

# --- ูุธููุฉ ุชุญููู ุงูุตูุฑ ---
@st.cache_data # ุงุณุชุฎุฏุงู ุงููุงุด ูุชุณุฑูุน ุงูุชุญููู
def load_image(image_name):
    if os.path.exists(image_name):
        return Image.open(image_name)
    else:
        st.error(f"โ๏ธ ุชูุจูู: ุงูุตูุฑุฉ '{image_name}' ููููุฏุฉ. ูุฑุฌู ุงูุชุฃูุฏ ูู ูุฌูุฏูุง ูู ุงููุฌูุฏ.")
        return None

# --- ุชุญููู ุงูุตูุฑ ุจุงูุชุฑุชูุจ ุงููุตุญุญ ---
# ุชู ุชุตุญูุญ ุงูุฑุจุท ุจูุงุกู ุนูู ุทูุจู ุงูุฃุฎูุฑ
images = {
    "final_erosion": load_image("image_0.png"), # ุงูุฎุฑูุทุฉ ุงูููุงุฆูุฉ
    "study_area_dem": load_image("image_1.png"), # ูุฌุงู ุงูุฏุฑุงุณุฉ (ุงูุงุฑุชูุงุนุงุช)
    "soil_k": load_image("image_2.png"),         # ูุนุงูู ูุงุจููุฉ ุงูุชุฑุจุฉ (K)
    "ls_factor": load_image("image_3.png"),      # ูุนุงูู ุงูุทูู ูุงูุงูุญุฏุงุฑ (LS)
    "veg_cover_c": load_image("image_4.png"),    # ูุนุงูู ุงูุชุบุทูุฉ ุงููุจุงุชูุฉ (C)
    "support_p": load_image("image_5.png"),      # ูุนุงูู ุงูููุงุฑุณุงุช ุงูุฒุฑุงุนูุฉ (P) - ุฌุฏูุฏ
    "rain_r": load_image("image_6.png"),         # ูุนุงูู ุงูุฃูุทุงุฑ (R) - ุชู ุงูุฅุจูุงุก ุนููู ููุงูุชูุงู
}

# ุฅููุงู ุงูุชุทุจูู ูู ุญุงู ููุฏุงู ุฃู ุตูุฑุฉ ุฃุณุงุณูุฉ
required_images = [images["final_erosion"], images["study_area_dem"]]
if None in required_images:
    st.warning("๐ด ูุฑุฌู ุงูุชุฃูุฏ ูู ูุฌูุฏ ุฌููุน ูููุงุช ุงูุตูุฑ ุงูุฃุณุงุณูุฉ (image_0.png ู image_1.png) ูู ุงููุฌูุฏ ูุชุดุบูู ุงูุชุทุจูู.")
    st.stop()


# --- ุงูุดุฑูุท ุงูุฌุงูุจู (Sidebar) ---
with st.sidebar:
    st.image("https://img-cdn.hytera.com/iwov-resources/hytera/02_products/4_banner_image/catagory_satellite_banner.jpg_n.webp", width=160) # ุฃููููุฉ ุฌุบุฑุงููุฉ
    st.title("ูุธุงู ูุฑุงูุจุฉ ุงูุชุนุฑูุฉ ๐ฐ๏ธ")
    st.subheader("ุญูุถ ููููุฉ ุงููุณุทู - ุงููุบุฑุจ")
    st.markdown("---")

    # ูุงุฆูุฉ ุชููู ุฌุงูุจูุฉ ุฃูููุฉ
    st.markdown("### ๐งญ ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ")
    selected_section = st.radio(
        "ุงุฎุชุฑ ูุณูุงู ููุนุฑุถ:",
        ["๐ ูุฌุงู ุงูุฏุฑุงุณุฉ ููุธุฑุฉ ุนุงูุฉ", "๐งฉ ุนูุงูู ุงูุชุนุฑูุฉ (ุงููุฏุฎูุงุช)", "๐ ุฎุฑูุทุฉ ุงููุฎุงุทุฑ ุงูููุงุฆูุฉ"],
        key="nav"
    )

    st.markdown("---")
    st.info(
        """
        **ุนู ุงููุดุฑูุน:**
        ููุตุฉ ุชูุงุนููุฉ ูุนุฑุถ ูุชุงุฆุฌ ููุฐุฌุฉ ูุฎุงุทุฑ ุงูุฌุฑุงู ุงูุชุฑุจุฉ (RUSLE) ูู ุญูุถ ููููุฉ ุงููุณุทูุ ุจุงุณุชุฎุฏุงู ุชูููุงุช ุงูุงุณุชุดุนุงุฑ ุนู ุจุนุฏ ููุธู ุงููุนูููุงุช ุงูุฌุบุฑุงููุฉ (GIS).
        """
    )

# --- ุงููุญุชูู ุงูุฑุฆูุณู ---

# ุจุงูุฑ ุนููู (Header Banner)
st.markdown("""
    <div class="header-banner">
        <h1>๐ง ุงููุญุฌูุจู ุฒูุฑูุงุกุ ูุดุงู ูุณูุน</h1>
        <p style="font-size: 1.2em; margin-top: 10px; color: #ecf0f1;">ุฏุฑุงุณุฉ ุชุทุจูููุฉ ุนูู ุญูุถ ููููุฉ ุงููุณุทู</p>
    </div>
""", unsafe_allow_html=True)


# ================= ุงููุณู 1: ูุฌุงู ุงูุฏุฑุงุณุฉ =================
if selected_section == "๐ ูุฌุงู ุงูุฏุฑุงุณุฉ ููุธุฑุฉ ุนุงูุฉ":
    st.markdown("""
    <div class="custom-container" style="border-top-color: #2ecc71;">
        <h2>โฐ๏ธ ุงูุฎุตุงุฆุต ุงูุทุจูุบุฑุงููุฉ ููุฌุงู ุงูุฏุฑุงุณุฉ</h2>
        <p>
        ููุน ุญูุถ ููููุฉ ุงููุณุทู ูู ููุทูุฉ ุชุชููุฒ ุจุชุถุงุฑูุณ ูุนูุฏุฉ ูููุงุฎ ุดุจู ุฌุงูุ ููุง ูุฌุนูู ุนุฑุถุฉ ููุฎุงุทุฑ ุงูุชุนุฑูุฉ ุงููุงุฆูุฉ.
        ุชุนุชุจุฑ ุงูุฎุตุงุฆุต ุงูุทุจูุบุฑุงููุฉ (ุงูุงุฑุชูุงุน ูุงูุงูุญุฏุงุฑ) ุงููุญุฑู ุงูุฃุณุงุณู ููุทุงูุฉ ุงููุงุฆูุฉ ุงููุณุจุจุฉ ููุงูุฌุฑุงู.
        </p>
    </div>
    """, unsafe_allow_html=True)

    col1, col2 = st.columns([2, 1]) # ุนููุฏ ุนุฑูุถ ููุฎุฑูุทุฉ ูุนููุฏ ุฃุถูู ููุดุฑุญ

    with col1:
        if images["study_area_dem"]:
            st.image(images["study_area_dem"], caption="ูููุฐุฌ ุงูุงุฑุชูุงุน ุงูุฑููู (DEM) - ููุถุญ ุชุถุงุฑูุณ ุญูุถ ููููุฉ ุงููุณุทู", use_column_width=True, output_format="PNG")

    with col2:
        st.markdown("""
        <div style="background-color: #e8f6f3; padding: 20px; border-radius: 10px; border-right: 4px solid #1abc9c;">
            <h4>๐ ูุฑุงุกุฉ ูู ุงูุฎุฑูุทุฉ:</h4>
            <ul>
                <li><b>ุงูุฃููุงู ุงูุจููุฉ/ุงูุญูุฑุงุก:</b> ุชุดูุฑ ุฅูู ุงูููุงุทู ุงูุฌุจููุฉ ุงููุฑุชูุนุฉ ูุงูุณููุญ ุงูุดุฏูุฏุฉุ ููู ููุงุจุน ุงูุชุนุฑูุฉ.</li>
                <li><b>ุงูุฃููุงู ุงูุฎุถุฑุงุก/ุงูุตูุฑุงุก:</b> ุชูุซู ุงูููุงุทู ุงูููุฎูุถุฉ ูุงูุณููู ุงูููุถูุฉ ููุฌุงุฑู ุงูุฃูุฏูุฉ ุงูุฑุฆูุณูุฉุ ููู ููุงุทู ุชุฑุณูุจ ูุญุชููุฉ.</li>
            </ul>
            <p style="font-size: 0.9em; margin-top: 15px;">
            <i class="far fa-lightbulb"></i> <b>ููุงุญุธุฉ:</b> ุงูุชุจุงูู ุงููุจูุฑ ูู ุงูุงุฑุชูุงุนุงุช ูุณุฑุน ูู ุฌุฑูุงู ุงูููุงู ุงูุณุทุญูุฉ ููุฒูุฏ ูู ูุฏุฑุชูุง ุงูุญุชูุฉ.
            </p>
        </div>
        """, unsafe_allow_html=True)


# ================= ุงููุณู 2: ุนูุงูู ุงูุชุนุฑูุฉ (ุงููุฏุฎูุงุช) =================
elif selected_section == "๐งฉ ุนูุงูู ุงูุชุนุฑูุฉ (ุงููุฏุฎูุงุช)":
    st.markdown("""
    <div class="custom-container" style="border-top-color: #f1c40f;">
        <h2>๐ ุงูุนูุงูู ุงููุคุซุฑุฉ ูู ุงูุชุนุฑูุฉ (ูููุฐุฌ RUSLE)</h2>
        <p>
        ุชุนุชูุฏ ุงูุฏุฑุงุณุฉ ุนูู ุฏูุฌ ุฎูุณุฉ ุนูุงูู ุฑุฆูุณูุฉ ูุชุญุฏูุฏ ููุฏุงู ุงูุชุฑุจุฉ ุงููุญุชูู. ููููู ุงุณุชูุดุงู ูู ุนุงูู ุนูู ุญุฏุฉ ุนุจุฑ ุนูุงูุงุช ุงูุชุจููุจ ุฃุฏูุงู.
        </p>
    </div>
    """, unsafe_allow_html=True)

    # ุงุณุชุฎุฏุงู ุชุจููุจุงุช ูุน ุฃููููุงุช (ุชู ุชุตุญูุญ ุงูุชุฑุชูุจ ูุงููุญุชูู ุญุณุจ ุทูุจู)
    tab_k, tab_ls, tab_c, tab_p, tab_r = st.tabs([
        "๐ซ ูุงุจููุฉ ุงูุชุฑุจุฉ (K)",
        "โฐ๏ธ ุงูุทูู ูุงูุงูุญุฏุงุฑ (LS)",
        "๐ฟ ุงูุบุทุงุก ุงููุจุงุชู (C)",
        "๐ ุงูููุงุฑุณุงุช ุงูุฒุฑุงุนูุฉ (P)",
        "๐ง๏ธ ุงููุงุจูุฉ ูููุทุฑ (R)"
    ])

    with tab_k:
        st.subheader("ุนุงูู ูุงุจููุฉ ุงูุชุฑุจุฉ ููุงูุฌุฑุงู (K-Factor)")
        st.info("ูุนูุณ ููุงููุฉ ููุน ุงูุชุฑุจุฉ ููุงููุตุงู ูุงูููู. ุงูุฃููุงู ุงูุฏุงููุฉ (ุงูุจูู/ุงูุฃุญูุฑ) ุชุดูุฑ ุฅูู ุชุฑุจุฉ ูุดุฉ ูุณููุฉ ุงูุงูุฌุฑุงู.")
        if images["soil_k"]: st.image(images["soil_k"], use_column_width=True)

    with tab_ls:
        st.subheader("ุนุงูู ุงูุทุจูุบุฑุงููุง ุงููุฑูุจ (LS-Factor)")
        st.info("ูุฏูุฌ ุชุฃุซูุฑ ุทูู ุงูููุญุฏุฑ ูุฏุฑุฌุฉ ุงูุญุฏุงุฑู. ุงูููุงุทู ุฐุงุช ุงูููู ุงูุนุงููุฉ (ุดุจูุฉ ุงูุฃูุฏูุฉ ูุงูุณููุญ) ุชุฒูุฏ ูููุง ุณุฑุนุฉ ูุชุฑููุฒ ุงูุฌุฑูุงู ุงูุณุทุญู.")
        if images["ls_factor"]: st.image(images["ls_factor"], use_column_width=True)

    with tab_c:
        st.subheader("ุนุงูู ุงูุบุทุงุก ุงููุจุงุชู (C-Factor)")
        st.success("ูุธูุฑ ุฏูุฑ ุงููุจุงุชุงุช ูู ุญูุงูุฉ ุงูุชุฑุจุฉ. ุงูููุงุทู ุงูุฎุถุฑุงุก ุชูุซู ุบุทุงุก ูุซูู (ุญูุงูุฉ ุนุงููุฉ)ุ ุจูููุง ุงูุฃุตูุฑ/ุงูุฃุญูุฑ ููุงุทู ุฌุฑุฏุงุก ุฃู ุฒุฑุงุนุฉ ุถุนููุฉ.")
        if images["veg_cover_c"]: st.image(images["veg_cover_c"], use_column_width=True)

    with tab_p:
        st.subheader("ุนุงูู ููุงุฑุณุงุช ุงูุญูุงุธ ุนูู ุงูุชุฑุจุฉ (P-Factor)")
        st.warning("ูุนูุณ ุชุฃุซูุฑ ุงูุชุฏุฎูุงุช ุงูุจุดุฑูุฉ (ูุซู ุงููุฏุฑุฌุงุชุ ุงูุญุฑุงุซุฉ ุงูููุชูุฑูุฉ) ูู ุชูููู ุงูุงูุฌุฑุงู. ุงูููู ุงูููุฎูุถุฉ ุชุนูู ูุฌูุฏ ููุงุฑุณุงุช ุญูุงูุฉ ูุนุงูุฉ.")
        if images["support_p"]: st.image(images["support_p"], use_column_width=True)

    with tab_r:
        st.subheader("ุนุงูู ุงููุงุจููุฉ ูููุทุฑ (R-Factor)")
        st.info("ููุซู ุงููุฏุฑุฉ ุงูุชุนุฑูุฉ ููุฃูุทุงุฑ ุจูุงุกู ุนูู ูููุชูุง ูุดุฏุชูุง ูู ุงูููุทูุฉ.")
        if images["rain_r"]: st.image(images["rain_r"], use_column_width=True)


# ================= ุงููุณู 3: ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ =================
elif selected_section == "๐ ุฎุฑูุทุฉ ุงููุฎุงุทุฑ ุงูููุงุฆูุฉ":
    st.markdown("""
    <div class="custom-container" style="border-top-color: #e74c3c; text-align: center;">
        <h2 style="color: #c0392b;">๐ฅ ุงูุฎุฑูุทุฉ ุงูุชุฑููุจูุฉ ููุฎุงุทุฑ ุงูุชุนุฑูุฉ ๐ฅ</h2>
        <p>
        ูุฐู ุงูุฎุฑูุทุฉ ูู ูุชุงุฌ ุฏูุฌ ุฌููุน ุงูุนูุงูู ุงูุณุงุจูุฉ ูุชูุถุญ ุงูุชูุฒูุน ุงููุฌุงูู ููููุงุทู ุงูุฃูุซุฑ ุชูุฏูุฏุงู ุจููุฏุงู ุงูุชุฑุจุฉ ูู ุญูุถ ููููุฉ ุงููุณุทู.
        </p>
    </div>
    """, unsafe_allow_html=True)

    # ุนุฑุถ ุงูุฎุฑูุทุฉ ุงูููุงุฆูุฉ ูู ุญุงููุฉ ูุจูุฑุฉ
    if images["final_erosion"]:
        st.image(images["final_erosion"], caption="ุงูุชูุฒูุน ุงููุฌุงูู ูููุฏุงู ุงูุชุฑุจุฉ ุงููุญุชูู (ุทู/ููุชุงุฑ/ุณูุฉ)", use_column_width=True)

    st.markdown("---")

    # ูุณู ุชุญููู ุงููุชุงุฆุฌ ุจุชุตููู ุฃุนูุฏุฉ
    st.subheader("๐ ุชุญููู ุงููุชุงุฆุฌ ูุงูุชูุตูุงุช")
    
    analysis_col1, analysis_col2 = st.columns(2)

    with analysis_col1:
        st.markdown("""
        <div style="background-color: #fdebd0; padding: 15px; border-radius: 10px; border-right: 4px solid #e67e22;">
            <h4>๐ด ููุงุทู ุงูุฎุทุฑ ุงูุดุฏูุฏ (ุงูุฃููุงู ุงูุฏุงููุฉ)</h4>
            <p>ุชุชุฑูุฒ ูู ุงูุณููุญ ุงูุฌุจููุฉ ุดุฏูุฏุฉ ุงูุงูุญุฏุงุฑ ูุฐุงุช ุงูุบุทุงุก ุงููุจุงุชู ุงูุถุนูู ูุงูุชุฑุจุฉ ุงููุดุฉ. ูุฐู ุงูููุงุทู ุชุชุทูุจ ุชุฏุฎูุงู ุนุงุฌูุงู.</p>
            <b>ุงูุชูุตูุงุช:</b>
            <ul>
                <li>ุชุดุฌูุฑ ููุซู ููุณููุญ.</li>
                <li>ุจูุงุก ูุฏุฑุฌุงุช ูุญูุงุฌุฒ ูุงุฆูุฉ ููุญุฏ ูู ุณุฑุนุฉ ุงูุฌุฑูุงู.</li>
            </ul>
        </div>
        """, unsafe_allow_html=True)

    with analysis_col2:
        st.markdown("""
        <div style="background-color: #d5f5e3; padding: 15px; border-radius: 10px; border-right: 4px solid #2ecc71;">
            <h4>๐ข ููุงุทู ุงูุฎุทุฑ ุงูููุฎูุถ (ุงูุฃููุงู ุงููุงุชุญุฉ)</h4>
            <p>ุชุชูุงุฌุฏ ูู ุงูููุงุทู ุงูุณูููุฉ ุฃู ุงูุบุงุจููุฉ ุงููุซููุฉ ุญูุซ ุชุชููุฑ ุญูุงูุฉ ุทุจูุนูุฉ ููุชุฑุจุฉ.</p>
            <b>ุงูุชูุตูุงุช:</b>
            <ul>
                <li>ุงูุญูุงุธ ุนูู ุงูุบุทุงุก ุงููุจุงุชู ุงูุญุงูู.</li>
                <li>ุชุทุจูู ููุงุฑุณุงุช ุฒุฑุงุนูุฉ ูุณุชุฏุงูุฉ (ูุซู ุงูุญุฑุงุซุฉ ุงูุญุงูุธุฉ).</li>
            </ul>
        </div>
        """, unsafe_allow_html=True)


# --- ุชุฐููู ุงูุตูุญุฉ ---
st.markdown("---")
st.markdown("""
<div style='text-align: center; color: #7f8c8d; padding: 20px;'>
    <p>ุชู ุชุทููุฑ ูุฐุง ุงูุชุทุจูู ูุฃุบุฑุงุถ ุงูุจุญุซ ุงูุนููู ูุนุฑุถ ุงููุชุงุฆุฌ ุงูุฌุบุฑุงููุฉ</p>
    <p>ยฉ 2025 - ุงููุญุฌูุจู ุฒูุฑูุงุกุ ูุฎุชุจุฑ ุฏููุงููุฉ ุงูุฃูุณุงุท ุงูุฌุงูุฉ ูุงูุชููุฆุฉ ุงูุฌูููุฉ</p>
</div>
""", unsafe_allow_html=True)






