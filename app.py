import streamlit as st
from PIL import Image
import os

# --- ุฅุนุฏุงุฏุงุช ุงูุตูุญุฉ ุงูุฃุณุงุณูุฉ ---
# ูุฌุจ ุฃู ุชููู ูุฐู ุฃูู ุฏุงูุฉ ูุชู ุงุณุชุฏุนุงุคูุง ูู ููุฏ Streamlit
st.set_page_config(
    page_title="ูุชุงุฆุฌ ุชุนุฑูุฉ ุงูุชุฑุจุฉ - ููููุฉ ุงููุณุทู",
    page_icon="๐",
    layout="wide",
    initial_sidebar_state="expanded"
)

# --- ุฅุนุฏุงุฏุงุช ุงูุงุชุฌุงู (ูู ุงููููู ุฅูู ุงููุณุงุฑ - RTL) ---
# ุญูู ููุฏ CSS ูุฅุฌุจุงุฑ ุงููุชุตูุญ ุนูู ุนุฑุถ ุงููุญุชูู ูู ุงููููู ูููุณุงุฑ
st.markdown(
    """
    <style>
    /* ุงุณุชูุฏุงู ุงูุญุงููุฉ ุงูุฑุฆูุณูุฉ ููุชุทุจูู ุจุงููุงูู */
    [data-testid="stAppViewContainer"] {
        direction: rtl;
        text-align: right;
        font-family: 'sans-serif'; /* ููููู ุชุบููุฑ ุงูุฎุท ููุง ุฅุฐุง ุฃุฑุฏุช */
    }

    /* ุถูุงู ุฃู ุงูุนูุงููู ูุงูููุฑุงุช ูุงููุตูุต ูุญุงุฐูุฉ ูููููู ุจุดูู ุฅุฌุจุงุฑู */
    h1, h2, h3, h4, h5, h6, p, span, div, label, .stMarkdown, .stText {
        text-align: right !important;
    }
    
    /* ุฅุตูุงุญ ุงุชุฌุงู ุงูููุงุฆู ุงูููุทูุฉ */
    ul, ol {
        direction: rtl;
        text-align: right;
        padding-right: 1.5rem; /* ูุณุงูุฉ ููุฑุตุงุตุงุช */
        padding-left: 0;
    }

    /* ุถุจุท ุงุชุฌุงู ุงูุนูุงุตุฑ ุฏุงุฎู ุงูุดุฑูุท ุงูุฌุงูุจู */
    section[data-testid="stSidebar"] {
        direction: rtl;
        text-align: right;
    }

    /* ุชุนุฏูู ูุญุงุฐุงุฉ ุชุจููุจุงุช (Tabs) ูุชููู ุนูู ุงููููู */
    .stTabs [data-baseweb="tab-list"] {
        justify-content: flex-end;
    }

    /* ุชุนุฏูู ุงุชุฌุงู ูุตูุต ุงูุชุจููุจุงุช ููุณูุง */
    .stTabs [data-baseweb="tab"] {
        direction: rtl;
        text-align: right;
    }
    
    /* ูุญุงุฐุงุฉ ุตูุฑ caption */
    .stImage > div > div > div {
         text-align: center !important; /* ุงููุตู ุชุญุช ุงูุตูุฑุฉ ูุจูู ูู ุงููุณุท ุฃุฌููุ ุฃู ุบูุฑู ูู right */
    }
    
    /* ุฅุตูุงุญ ููุญุงุฐุงุฉ ุจุนุถ ุนูุงุตุฑ ุงูุฅุฏุฎุงู ูุซู radio buttons */
    .stRadio > div {
        align-items: flex-end;
    }
    </style>
    """,
    unsafe_allow_html=True,
)

# --- ูุธููุฉ ูุณุงุนุฏุฉ ูุชุญููู ุงูุตูุฑ ุจุฃูุงู ---
def load_image(image_name):
    if os.path.exists(image_name):
        return Image.open(image_name)
    else:
        st.error(f"ุฎุทุฃ: ุงูุตูุฑุฉ '{image_name}' ุบูุฑ ููุฌูุฏุฉ ูู ุงููุฌูุฏ ุงูุญุงูู.")
        return None

# --- ุชุญููู ุงูุตูุฑ ---
# ุชุญููู ุงูุตูุฑ ูุฑุฉ ูุงุญุฏุฉ ูู ุงูุจุฏุงูุฉ ูุชุณุฑูุน ุงูุฃุฏุงุก
# ุชุฃูุฏ ูู ุฃู ุฃุณูุงุก ุงููููุงุช ููุง ูุทุงุจูุฉ ุชูุงูุงู ูููููุงุช ุงูููุฌูุฏุฉ ูู ูุฌูุฏู
images = {
    "final_erosion": load_image("image_0.png"),
    "elevation": load_image("image_1.png"),
    "slope": load_image("image_2.png"),
    "veg_cover_c": load_image("image_3.png"),
    "soil_k": load_image("image_4.png"),
    "ls_factor": load_image("image_5.png"),
    "rain_r": load_image("image_6.png"),
}

# ุงูุชุญูู ูู ุชุญููู ุฌููุน ุงูุตูุฑ ุจูุฌุงุญ ูุจู ุงููุชุงุจุนุฉ ูุชุฌูุจ ุชููู ุงูุชุทุจูู
if None in images.values():
    st.stop()

# --- ุงูุดุฑูุท ุงูุฌุงูุจู (Sidebar) ููุชููู ---
st.sidebar.title("ูุธุงู ูุฑุงูุจุฉ ุงูุชุนุฑูุฉ ๐๏ธ")
st.sidebar.subheader("ุญูุถ ููููุฉ ุงููุณุทู")
st.sidebar.markdown("---")

# ุฎูุงุฑุงุช ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ
menu_options = ["ุงูุฑุฆูุณูุฉ ูุงูููุทูุฉ", "ุนูุงูู ุงูุชุนุฑูุฉ (ุงููุฏุฎูุงุช)", "ุฎุฑูุทุฉ ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ"]
# ุฅุถุงูุฉ ููุชุงุญ ูุฑูุฏ (key) ูุนูุตุฑ ุงูุงุฎุชูุงุฑ ูุชุฌูุจ ูุดุงูู ุงูุชุญุฏูุซ ุฃุญูุงูุงู
selection = st.sidebar.radio("ุงูุชูู ุฅูู ุงููุณู:", menu_options, key="navigation_radio")

st.sidebar.markdown("---")
st.sidebar.info(
    """
    **ุนู ุงูุชุทุจูู:**
    ูุฐู ูุงุฌูุฉ ุชูุงุนููุฉ ูุนุฑุถ ูุชุงุฆุฌ ุฏุฑุงุณุฉ ููุฐุฌุฉ ูุฎุงุทุฑ ุงูุฌุฑุงู ุงูุชุฑุจุฉ ูู ููุทูุฉ ููููุฉ ุงููุณุทูุ ุจุงุณุชุฎุฏุงู ูุธู ุงููุนูููุงุช ุงูุฌุบุฑุงููุฉ (GIS).
    """
)

# --- ูุญุชูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ---
st.title("๐บ๏ธ ููุญุฉ ุนุฑุถ ูุชุงุฆุฌ ุฏุฑุงุณุฉ ุชุนุฑูุฉ ุงูุชุฑุจุฉ")
st.subheader("ููุทูุฉ ุงูุฏุฑุงุณุฉ: ุญูุถ ููููุฉ ุงููุณุทู")

# --- ุงููุณู 1: ุงูุฑุฆูุณูุฉ ููุธุฑุฉ ุนุงูุฉ ---
if selection == "ุงูุฑุฆูุณูุฉ ูุงูููุทูุฉ":
    st.markdown("""
    ูุฑุญุจุงู ุจู ูู ุจูุงุจุฉ ุนุฑุถ ูุชุงุฆุฌ ุฏุฑุงุณุฉ ูุฎุงุทุฑ ุงูุชุนุฑูุฉ. ุชูุฏู ูุฐู ุงูุฏุฑุงุณุฉ ุฅูู ุชุญุฏูุฏ ุงูููุงุทู ุงูุฃูุซุฑ ุนุฑุถุฉ ูููุฏุงู ุงูุชุฑุจุฉ ูู ุญูุถ ููููุฉ ุงููุณุทู.
    
    ูุณุชุนุฑุถ ูู ูุฐุง ุงููุณู ุงูุฎุตุงุฆุต ุงูุทุจูุบุฑุงููุฉ ุงูุนุงูุฉ ููููุทูุฉ ููุฏุฎู ูููู ุงูุนูุงูู ุงููุคุซุฑุฉ ูุงุญูุงู.
    """)

    col1, col2 = st.columns(2)

    # ูู ูุถุน RTLุ ุงูุฃุนูุฏุฉ ุณุชูุนูุณ ุชููุงุฆูุงู (ุงูุนููุฏ 1 ูุตุจุญ ุนูู ุงููููู)
    with col1:
        st.markdown("### ูููุฐุฌ ุงูุงุฑุชูุงุน ุงูุฑููู (DEM)")
        st.write("ุชูุถุญ ูุฐู ุงูุฎุฑูุทุฉ ุชุจุงูู ุงูุงุฑุชูุงุนุงุช ูู ุงูุญูุถุ ุญูุซ ุชูุซู ุงูุฃููุงู ุงูุจููุฉ ุงูููุงุทู ุงูุฌุจููุฉ ุงููุฑุชูุนุฉุ ูุงูุฃุฎุถุฑ ุงูููุงุทู ุงูููุฎูุถุฉ.")
        st.image(images["elevation"], caption="ุฎุฑูุทุฉ ุงูุงุฑุชูุงุนุงุช (DEM) ูุญูุถ ููููุฉ ุงููุณุทู", use_column_width=True)

    with col2:
        st.markdown("### ุฎุฑูุทุฉ ุงูุงูุญุฏุงุฑ (Slope)")
        st.write("ุชูุธูุฑ ุฏุฑุฌุงุช ุงูููู ูู ุงูููุทูุฉ. ุงูููุงุทู ุฐุงุช ุงูููู ุงูุฃุญูุฑ ุงูุฏุงูู ูู ุงูุฃุดุฏ ุงูุญุฏุงุฑุงู ูุจุงูุชุงูู ุงูุฃูุซุฑ ุนุฑุถุฉ ููุทุงูุฉ ุงูุญุฑููุฉ ููููุงู.")
        st.image(images["slope"], caption="ุฎุฑูุทุฉ ูุฆุงุช ุงูุงูุญุฏุงุฑ", use_column_width=True)


# --- ุงููุณู 2: ุนูุงูู ุงูุชุนุฑูุฉ (ุงููุฏุฎูุงุช) ---
elif selection == "ุนูุงูู ุงูุชุนุฑูุฉ (ุงููุฏุฎูุงุช)":
    st.header("๐ ุงูุนูุงูู ุงููุคุซุฑุฉ ูู ุงูุชุนุฑูุฉ (ูุฏุฎูุงุช ุงููููุฐุฌ)")
    st.write("""
    ุชุนุชูุฏ ููุฐุฌุฉ ุงูุชุนุฑูุฉ (ุบุงูุจุงู ุจุงุณุชุฎุฏุงู ูุนุงุฏูุงุช ูุซู RUSLE) ุนูู ุฏูุฌ ุนุฏุฉ ุนูุงูู ุจูุฆูุฉ.
    ููููู ุงุณุชุนุฑุงุถ ูุฐู ุงูุนูุงูู ุจุงูุชูุตูู ูู ุฎูุงู ุนูุงูุงุช ุงูุชุจููุจ ุงูุชุงููุฉ:
    """)

    # ุงุณุชุฎุฏุงู Tabs ูุชุฑุชูุจ ุงูุนูุงูู ุจุดูู ุฃููู. ุณุชุธูุฑ ุงูุขู ูู ุงููููู ูููุณุงุฑ.
    tab1, tab2, tab3, tab4 = st.tabs(["๐ง๏ธ ุงููุงุจูุฉ ูููุทุฑ (R)", "๐ซ ูุงุจููุฉ ุงูุชุฑุจุฉ (K)", "๐ฟ ุงูุบุทุงุก ุงููุจุงุชู (C)", "โฐ๏ธ ุนุงูู ุงูุทุจูุบุฑุงููุง (LS)"])

    with tab1:
        st.subheader("ุนุงูู ุงููุงุจููุฉ ูููุทุฑ (R-Factor)")
        st.write("ููุซู ุงููุฏุฑุฉ ุงูุชุนุฑูุฉ ููุฃูุทุงุฑ ุจูุงุกู ุนูู ูููุชูุง ูุดุฏุชูุง. ุงูููุงุทู ุงูุฒุฑูุงุก ุงูุฏุงููุฉ ุชุดูุฑ ุฅูู ุทุงูุฉ ูุทุฑูุฉ ุฃุนูู.")
        st.image(images["rain_r"], caption="ุฎุฑูุทุฉ ุชูุฒูุน ุนุงูู ุงููุงุจููุฉ ูููุทุฑ (R)", use_column_width=True)

    with tab2:
        st.subheader("ุนุงูู ูุงุจููุฉ ุงูุชุฑุจุฉ ููุงูุฌุฑุงู (K-Factor)")
        st.write("ูุนูุณ ููุงููุฉ ููุน ุงูุชุฑุจุฉ ููุงููุตุงู ูุงูููู. ุงูุฃููุงู ุงูุฏุงููุฉ ุชุดูุฑ ุฅูู ุชุฑุจุฉ ุฃูุซุฑ ูุดุงุดุฉ ููุงุจููุฉ ููุงูุฌุฑุงู.")
        st.image(images["soil_k"], caption="ุฎุฑูุทุฉ ุนุงูู ูุงุจููุฉ ุงูุชุฑุจุฉ (K)", use_column_width=True)

    with tab3:
        st.subheader("ุนุงูู ุงูุบุทุงุก ุงููุจุงุชู ูุฅุฏุงุฑุฉ ุงููุญุงุตูู (C-Factor)")
        st.write("ูุธูุฑ ุฏูุฑ ุงูุบุทุงุก ุงููุจุงุชู ูู ุญูุงูุฉ ุงูุชุฑุจุฉ. ุงูููุงุทู ุงูุฎุถุฑุงุก ุชูุซู ุบุทุงุก ูุจุงุชู ูุซูู (ุญูุงูุฉ ุนุงููุฉ)ุ ุจูููุง ุงูุฃุตูุฑ ููุซู ููุงุทู ุฌุฑุฏุงุก ุฃู ุฒุฑุงุนุฉ ุถุนููุฉ.")
        st.image(images["veg_cover_c"], caption="ุฎุฑูุทุฉ ุนุงูู ุงูุบุทุงุก ุงููุจุงุชู (C)", use_column_width=True)

    with tab4:
        st.subheader("ุนุงูู ุงูุทุจูุบุฑุงููุง ุงููุฑูุจ (LS-Factor)")
        st.write("ูุฏูุฌ ุชุฃุซูุฑ ุทูู ุงูููุญุฏุฑ (L) ูุฏุฑุฌุฉ ุงูุญุฏุงุฑู (S). ุงูููุงุทู ุฐุงุช ุงูููู ุงูุนุงููุฉ (ุงูุฃููุงู ุงูุฏุงูุฆุฉ/ุงูุฒุฑูุงุก ูู ูุฌุงุฑู ุงูุฃูุฏูุฉ) ุชุฒูุฏ ูููุง ุณุฑุนุฉ ูุชุฑููุฒ ุงูุฌุฑูุงู ุงูุณุทุญู.")
        st.image(images["ls_factor"], caption="ุฎุฑูุทุฉ ุนุงูู ุงูุทุจูุบุฑุงููุง (LS)", use_column_width=True)


# --- ุงููุณู 3: ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ ---
elif selection == "ุฎุฑูุทุฉ ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ":
    st.header("๐ ุงูุฎุฑูุทุฉ ุงูููุงุฆูุฉ ููุฎุงุทุฑ ุงูุชุนุฑูุฉ")
    st.warning("ูุฐู ุงูุฎุฑูุทุฉ ูู ูุชุงุฌ ุฏูุฌ ุฌููุน ุงูุนูุงูู ุงูุณุงุจูุฉ ูุชูุถุญ ุงูุชูุฒูุน ุงููุฌุงูู ูููุฏุงู ุงูุชุฑุจุฉ ุงููุชููุน.")

    # ุนุฑุถ ุงูุฎุฑูุทุฉ ุงูููุงุฆูุฉ ุจุญุฌู ูุจูุฑ
    st.image(images["final_erosion"], caption="ุงูุฎุฑูุทุฉ ุงูุชุฑููุจูุฉ ููุฎุงุทุฑ ุงูุชุนุฑูุฉ ูู ููููุฉ ุงููุณุทู", use_column_width=True)

    st.markdown("""
    ### ๐ ุชุญููู ุฃููู ูููุชุงุฆุฌ:
    ุจูุงุกู ุนูู ููุชุงุญ ุงูุฎุฑูุทุฉ ูุงูุฃููุงู ุงูุธุงูุฑุฉ:
    * **ุงูููุงุทู ุฐุงุช ุงูููู ุงูุจุฑุชูุงูู ุงูุฏุงูู/ุงูุจูู (ุงูููู ุงูุนุงููุฉ ูู ุงูููุชุงุญ):** ุชูุซู ุงูููุงุทู ุฐุงุช ุงููุฎุงุทุฑ ุงูุดุฏูุฏุฉ ููุชุนุฑูุฉ. ุบุงูุจุงู ูุง ุชุชุทุงุจู ูุฐู ุงูููุงุทู ูุน ุงูุงูุญุฏุงุฑุงุช ุงูุดุฏูุฏุฉ (ููุง ุฑุฃููุง ูู ุฎุฑูุทุฉ Slope) ูุงูุบุทุงุก ุงููุจุงุชู ุงูุถุนูู.
    * **ุงูููุงุทู ุฐุงุช ุงูููู ุงูุจุฑุชูุงูู ุงููุงุชุญ (ุงูููู ุงูููุฎูุถุฉ):** ุชูุซู ููุงุทู ุฐุงุช ูุฎุงุทุฑ ุชุนุฑูุฉ ููุฎูุถุฉ ุฅูู ูุชูุณุทุฉุ ูุบุงูุจุงู ูุง ุชููู ูู ุงูููุงุทู ุงูุณูููุฉ ุฃู ุฐุงุช ุงูุบุทุงุก ุงููุจุงุชู ุงูุฌูุฏ.
    
    **ุงูุงุณุชูุชุงุฌ:**
    ุชุชุฑูุฒ ุงููุฎุงุทุฑ ุงูุนุงููุฉ ุจุดูู ูุงุถุญ ุนูู ุงูุณููุญ ุงูุฌุจููุฉ ูุงูููุงุทู ุงููุชููุฌุฉ ูู ุงูุญูุถุ ููุง ูุณุชุฏุนู ุชุฏุงุจูุฑ ุตูุงูุฉ ุนุงุฌูุฉ ูู ุชูู ุงููุทุงูุงุช.
    """)

# --- ุชุฐููู ุงูุตูุญุฉ ---
st.markdown("---")
# ุงุณุชุฎุฏุงู HTML ุจุณูุท ูุถูุงู ุชูุณูุท ุญููู ุงููุดุฑ
st.markdown("<div style='text-align: center;'>ยฉ 2023 - ูุธุงู ุนุฑุถ ูุชุงุฆุฌ ุฏุฑุงุณุฉ ุงูุชุนุฑูุฉ - ููููุฉ ุงููุณุทู</div>", unsafe_allow_html=True)
